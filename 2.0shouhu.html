<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="shortcut icon" href="https://static.codemao.cn/coco/player/unstable/HykDlfJER.image/png?hash=Fgn2Axb9RKvu3CZukIYdX6b_huYO">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>休息提示</title>
    <style>
    h3 {
    font-size: 1.75em; /* 设置h1标签的字体大小为1.75em */
    }
    .loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: white;
    z-index: 10000;
    display: flex;
    justify-content: center;
    align-items: center;
    }

    .spinner {
        border: 16px solid #f3f3f3; /* Light grey */
        border-top: 16px solid #3498db; /* Blue */
        border-radius: 50%;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    body {
        font-family: 'Microsoft YaHei';
        background-image: url("https://static.codemao.cn/coco/player/unstable/rk--rV-8C.image/webp?hash=Fg92g8NFfyBDTArS0OMZDlXoH2Av");
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        transition: background-color 0.5s, color 0.5s;
        overflow: hidden;
        
        /* 确保背景图片完整显示 */
        background-size: cover;
        background-position: center; /* 图片居中显示 */
        
        /* 添加高斯模糊遮罩 */
        backdrop-filter: blur(3px); /* 可以调整模糊程度 */
    }

    h1 {
        font-size: 2.5rem;
    }
    p {
        font-size: 2rem;
    }
    .timer {
        font-size: 4rem;
        margin-top: 20px;
    }
    .class-time {
    background-color: white;
    color: black;
    transition: background-color 0.5s, color 0.5s; /* 平滑过渡 */
    }

    .break-time {
    background-color: initial; /* 返回原始设置 */
    color: white;
    transition: background-color 0.5s, color 0.5s;
    }

    .footer {
        position: absolute;
        bottom: 20px;
        font-size: 1.5rem;
        animation: pulsate 1s infinite;
        cursor: pointer;
    }
    @keyframes pulsate {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    .schedule {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        width: 100%;
    }
    .schedule img {
        width: 16%;
    }
    .song-request {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #fff;
        color: #000;
        padding: 10px 20px;
        font-size: 1.5rem;
        cursor: pointer;
        border-radius: 5px;
        transition: background-color 0.3s, color 0.3s;
    }
    .song-request:hover {
        background-color: #000;
        color: #fff;
    }
    #songRequestPanel {
        position: fixed;
        top: 0;
        right: 0;
        width: 0;
        height: 100%;
        background-color: rgba(44, 44, 44, 0.9);
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
        display: none;
        flex-direction: column;
        align-items: center;
        color: white;
        border-radius: 10px;
    }
    #songRequestPanel a {
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 25px;
        color: #818181;
        display: block;
        transition: 0.3s;
    }
    #songRequestPanel a:hover {
        color: #f1f1f1;
    }
    #songRequestPanel .closebtn {
        position: absolute;
        top: 0;
        right: 25px;
        font-size: 36px;
    }
    #songRequestPanel iframe {
        width: 90%;
        height: 80%;
        border-radius: 10px;
    }
    /* 修改.logo类来适配长条形图标 */
    .logo {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 350px; /* 根据实际图标的宽度进行调整 */
        height: 70px; /* 根据实际图标的高度进行调整，保持适当的宽高比 */
        object-fit: contain; /* 确保图片内容完整显示而不裁剪 */
    }
    .announcement {
        position: absolute;
        top: 10px;
        left: 70px;
        color: #fff;
        background-color: rgba(0, 0, 0, 0.5);
        padding: 10px;
        border-radius: 5px;
        font-size: 0.5rem;
    }
    .danmaku {
        position: absolute;
        white-space: nowrap;
        padding: 10px 20px;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        border-radius: 10px;
        font-size: 1.5rem;
        animation: move 10s linear infinite;
        cursor: pointer;
    }
    @keyframes move {
        from { transform: translateX(100vw); }
        to { transform: translateX(-100vw); }
    }
    .mode-switcher {
    display: flex;
    border: 1px solid #ccc; /* 边框颜色可以根据需要调整 */
    border-radius: 20px; /* 圆角大小 */
    overflow: hidden;
    margin-top: 20px;
    }

    .mode-option {
    flex: 1;
    text-align: center;
    padding: 10px 20px;
    cursor: pointer;
    transition: background-color 0.3s;
    }

    .mode-option.active {
    background-color: #ddd; /* 激活状态的背景颜色 */
    }

    .danmaku-input {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: flex;
        align-items: center;
        background-color: rgba(255, 255, 255, 0.1);
        padding: 10px;
        border-radius: 10px;
    }
    .danmaku-input input {
        padding: 10px;
        font-size: 1.5rem;
        border-radius: 5px;
        border: none;
        margin-right: 10px;
        background-color: rgba(255, 255, 255, 0.8);
    }
    .danmaku-input button {
        padding: 10px 20px;
        font-size: 1.5rem;
        border-radius: 5px;
        border: none;
        background-color: #fff;
        color: #000;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
    }
    .danmaku-input button:hover {
        background-color: #000;
        color: #fff;
    }
    .danmaku-input select {
        padding: 10px;
        font-size: 1.5rem;
        border-radius: 5px;
        border: none;
        margin-right: 10px;
        background-color: rgba(255, 255, 255, 0.8);
    }
    .custom-alert {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        z-index: 1000;
        display: none;
    }
    .custom-alert button {
        background-color: #fff;
        color: #000;
        padding: 10px 20px;
        margin-top: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
    }
    .custom-alert button:hover {
        background-color: #000;
        color: #fff;
    }
    .fullscreen-alert {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        z-index: 1000;
        display: none;
    }
    .fullscreen-alert input {
        width: 2rem;
        margin: 0 5px;
        font-size: 2rem;
        text-align: center;
        border: none;
        background-color: rgba(255, 255, 255, 0.8);
        border-radius: 5px;
    }
    .fullscreen-alert button {
        background-color: #fff;
        color: #000;
        padding: 10px 20px;
        margin-top: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
    }
    .fullscreen-alert button:hover {
        background-color: #000;
        color: #fff;
    }
    .english-word-card {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background-color: #fff;
        color: #000;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        z-index: 100;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        width: 250px;
    }
    .english-word-card img {
        width: 100%;
        border-radius: 10px;
    }
    .english-word-card .content {
        font-size: 1rem;
        margin-top: 10px;
    }
    .english-word-card .note {
        font-size: 0.9rem;
        margin-top: 5px;
        color: #666;
    }
    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: white;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    .loading-screen img {
        width: 100px;
        height: auto;
    }
    .loading-screen .message {
        font-size: 1rem;
        color: black;
        margin-top: 10px;
        text-align: center;
    }
    .info-panel {
    position: fixed;
    top: 10px;
    right: 10px;
    background-color: rgba(255, 255, 255, 0);
    padding: 10px;
    border-radius: 5px;
    z-index: 100;
    }
    .disclaimer {
    position: absolute;
    bottom: 0;
    width: 100%;
    text-align: center;
    font-size: 0.75rem;
    color: #666;
    padding: 10px 0;
    background-color: rgba(255, 255, 255, 0.5);  // 透明背景
    }


</style>
<script>
    // 敏感词列表
    var forbiddenWords = ["死妈", "你妈", "牢大", "***", "1713", "0210", "0242", "死", "妈", "草", "蛋", "b", "逼", "dick", "diss", "去", "原神", "17", "马瑶", "乌龟", "廖", "老", "登", "骚", "干", "睡", "捅", "熊", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0"];

    // 自定义弹窗显示
    function showAlert(message) {
        var alertBox = document.getElementById('alertBox');
        var alertMessage = document.getElementById('alertMessage');
        alertMessage.textContent = message;
        alertBox.style.display = 'block';
    }

    // 关闭自定义弹窗
    function closeAlert() {
        var alertBox = document.getElementById('alertBox');
        alertBox.style.display = 'none';
    }

    function startCountdown(duration, display, callback) {
        var timer = duration, minutes, seconds;
        var interval = setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);
            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;
            display.textContent = minutes + ":" + seconds;

            if (timer === 5 * 60) {
                tryPlayAudio('fiveMinuteAudio');
            }
            if (timer === 2 * 60) {
                tryPlayAudio('twoMinuteAudio');
            }
            if (--timer < 0) {
                clearInterval(interval);
                callback();
            }
        }, 1000);
    }



    function updateDateTime() {
        const date = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        const dateTimeFormat = new Intl.DateTimeFormat('zh-CN', options);
        document.getElementById('datetime').textContent = dateTimeFormat.format(date);
    }

    // 每秒更新时间
    setInterval(updateDateTime, 1000);
    window.onload = updateDateTime;




    function closeWindow() {
        document.getElementById('fullscreenAlert').style.display = 'flex';
    }

    function checkPassword() {
        const inputs = document.querySelectorAll('#fullscreenAlert input');
        const password = Array.from(inputs).map(input => input.value).join('');
        if (password === '1234') { // 将 '1234' 替换为实际密码
            window.close();
        } else {
            alert('密码错误');
        }
    }

    function closeBrowserWindow() {
        if (navigator.userAgent.indexOf("Chrome") != -1) {
            var win = window.open("", "_self");
            win.close();
            if (win) {
                win.opener = null;
                win.close();
            }
        } else {
            window.open("about:blank", "_self");
            window.close();
        }
    }

    function getNextBreakTime() {
        const now = new Date();
        const breakTimes = [
            { hour: 9, minute: 20 },
            { hour: 10, minute: 15 },
            { hour: 11, minute: 15 },
            { hour: 12, minute: 0 },
            { hour: 12, minute: 40 },
            { hour: 15, minute: 30 },
            { hour: 16, minute: 25 },
            { hour: 17, minute: 20 }
        ];

        // 计算当前时间距离今天最近的下课时间
        let nearestBreakTime = breakTimes.find(time => {
            let breakTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), time.hour, time.minute);
            return now < breakTime;
        });

        // 如果已经过了今天所有的下课时间，则取明天的第一个下课时间
        if (!nearestBreakTime) {
            nearestBreakTime = breakTimes[0];
        }

        // 计算下课时间与当前时间的时间差
        let nextBreakTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), nearestBreakTime.hour, nearestBreakTime.minute);
        let duration = Math.floor((nextBreakTime - now) / 1000);
        return { breakTime: nextBreakTime, duration: duration };
    }

    function startBreakCountdown() {
        const now = new Date();
        const { breakTime, duration } = getNextBreakTime();
        const display = document.querySelector('.timer');
        const header = document.querySelector('h1');
        startCountdown(duration, display, function () {
            header.textContent = '上课啦';
            display.textContent = '';
            setTimeout(closeBrowserWindow, 5000); // 上课后5秒自动关闭窗口
        });
    }

    window.onload = function () {
        document.body.requestFullscreen();
        startBreakCountdown();
        generateDanmaku();
        fetchDailyEnglish();
        hideLoadingScreen();
        switchMode('complex');
    };

    function openSongRequest() {
        document.getElementById("songRequestPanel").style.display = "flex";
        document.getElementById("songRequestPanel").style.width = "25%";
    }

    function closeSongRequest() {
        document.getElementById("songRequestPanel").style.width = "0";
        setTimeout(function () {
            document.getElementById("songRequestPanel").style.display = "none";
        }, 500);
    }

    var blockedWords = [];

    // 获取古诗词API
    function fetchPoetry() {
        fetch('https://v1.jinrishici.com/rensheng/lizhi.json')
            .then(response => response.json())
            .then(data => {
                var message = `${data.content} - ${data.author} 的 ${data.origin}`;
                createDanmaku(message);
            })
            .catch(error => console.error('Error fetching poetry:', error));
        fetch('https://v1.jinrishici.com/rensheng/zheli.json')
            .then(response => response.json())
            .then(data => {
                var message = `${data.content} - ${data.author} 的 ${data.origin}`;
                createDanmaku(message);
            })
            .catch(error => console.error('Error fetching poetry:', error));
    }

    // 随机弹幕功能
    function generateDanmaku() {
        setInterval(function () {
            //fetchPoetry();
        }, 5000);
    }

    function isBlocked(message) {
        for (var i = 0; i < blockedWords.length; i++) {
            if (message.includes(blockedWords[i])) {
                return true;
            }
        }
        return false;
    }
    
    function createDanmaku(message, color = 'white') {
        var danmaku = document.createElement("div");
        danmaku.className = "danmaku";
        danmaku.textContent = message;
        danmaku.style.color = color;
        danmaku.style.top = Math.random() * (window.innerHeight - 50) + "px";
        document.body.appendChild(danmaku);
        setTimeout(function () {
            document.body.removeChild(danmaku);
        }, 10000);
    }

    // 用户发送弹幕功能
    function sendDanmaku() {
        var input = document.querySelector('.danmaku-input input');
        var color = document.querySelector('.danmaku-input select').value;
        var message = input.value;
        for (var i = 0; i < forbiddenWords.length; i++) {
            if (message.includes(forbiddenWords[i])) {
                showAlert('不能发送包含敏感词的弹幕，本次异常行为已上传至⌈班主任后台⌋，错误类型：弹幕功能暂时关闭，敬请期待。');
                return;
            }
        }
        if (message.trim() !== "") {
            //取消下方注释开启弹幕功能
            //createDanmaku(message, color);
            //input.value = "";
            showAlert('错误类型：弹幕功能暂时关闭，敬请期待。');
            return;
        }
    }

    // 获取每日英语 API
    function fetchDailyEnglish() {
        fetch('https://api.oioweb.cn/api/common/OneDayEnglish')
            .then(response => response.json())
            .then(data => {
                var content = data.result.img;
                displayDailyEnglish(content);
            })
            .catch(error => console.error('错误，联系电教员:', error));
    }

    // 显示每日英语
    function displayDailyEnglish(content) {
        var card = document.createElement('div');
        //card.className = 'english-word-card';
        //card.innerHTML = `<img src="${content}" alt="每日英语">`;
        //card.innerHTML = `<img src="https://static.codemao.cn/coco/player/unstable/HkLfhYyYC.image/png?hash=Fgyjme8kB4meddcn3-4NLBOogu6T" alt="公告">`;
        document.body.appendChild(card);
    }

    // 隐藏加载屏幕
    function hideLoadingScreen() {
        document.querySelector('.loading-screen').style.display = 'none';
    }
    function switchMode(mode) {
        const allElements = document.querySelectorAll('.danmaku, .english-word-card, .song-request, .danmaku-input');
        const modeOptions = document.querySelectorAll('.mode-option');
        modeOptions.forEach(el => el.classList.remove('active')); // 移除所有的active类

        if (mode === 'complex') {
            allElements.forEach(el => el.style.display = 'block'); // 显示所有相关元素
            document.querySelector('.mode-option:nth-child(1)').classList.add('active'); // 添加active类到"复杂"选项
        } else if (mode === 'simple') {
            allElements.forEach(el => el.style.display = 'none'); // 隐藏所有相关元素
            document.querySelector('.mode-option:nth-child(2)').classList.add('active'); // 添加active类到"极简"选项
        }
    }
    function startBreakCountdown() {
        const now = new Date();
        const { breakTime, duration } = getNextBreakTime();
        const display = document.querySelector('.timer');
        const header = document.querySelector('h1');
        startCountdown(duration, display, function () {
            header.textContent = '上课啦';
            display.textContent = '';
            document.body.classList.add('class-time');
            setTimeout(() => {
                document.body.classList.remove('class-time');
                window.location.href = 'https://cyychenyiyi.github.io/ClassGuardian/closeok'; // 添加跳转链接
            }, 1000);
        });
    }


</script>
</head>
<body>


<div class="loading-screen">
    <div class="spinner"></div>
</div>
    
<div class="info-panel">
    <div id="datetime">加载中...</div>
</div>
<h1>恭喜同学们升入「初二」年级</h1>
<p>新一代ClassGuardian「天启守护架构」守护课间电脑安全</p>
<p>距离上课还有：</p>
<div class="timer">loading……</div>
<div class="schedule">
    <img src="https://static.codemao.cn/coco/player/unstable/SkHXq4-LA.image/png?hash=Fmw37gZARRPHO2lNi93GE0RcAq0C" alt="课程表图片">
</div>
<button style="background-color: white; color: black; font-size: 22px; border: none; border-radius: 8px; transition: transform 0.3s ease-in-out; padding: 12px 24px;" onmouseover="this.style.transform='scale(1.1)';" onmouseout="this.style.transform='scale(1)';" onclick="window.location.href='https://cyychenyiyi.github.io/ClassGuardian/close';">点我开始上课</button>
<footer class="disclaimer">
    测试程序，不代表最终效果。请勿将此软件用于非法用途。©️2024-2025 Chenyiyi
</footer>


<img class="logo" src="https://cyychenyiyi.github.io/ClassGuardian/logo_white.png" alt="LOGO">
</body>
</html>
